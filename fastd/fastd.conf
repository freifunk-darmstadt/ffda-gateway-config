log level debug;

# Set the interface name
interface "vpn_ffda";

# Support xsalsa20 and aes128 encryption methods, prefer xsalsa20
method "salsa2012+gmac";

# Bind to a fixed port, IPv4 only
bind 0.0.0.0:3332;

# Secret key generated by `fastd --generate-key`
secret "<yours, not mine...>";

# Set the interface MTU for TAP mode with xsalsa20/aes128 over IPv4 with a base MTU of 1492 (PPPoE)
# (see MTU selection documentation)
mtu 1406;

# Include peers from the directory 'peers'
include peers from "peers";

secure handshakes yes;

# adjust upstream/downstream speed and choose mac address
# https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/5/html/Virtualization/sect-Virtualization-Tips_and_tricks-Generating_a_new_unique_MAC_address.html

# TODO in script
# TODO use hotplug event to add bat0 to bridge

on up "ip link set address <generated mac address> dev $INTERFACE && ip link set up dev $INTERFACE && batctl -m bat0 if add $INTERFACE && batctl gw_mode server  100mbit/100mbit && ip link set bat0 up && brctl addif freifunk bat0";
